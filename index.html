<!DOCTYPE html>
<html>
<head>
<title>Campus Recovery Portal</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

/* ===== BACKGROUND + WATER GLOW ===== */
body{
    background:
        radial-gradient(circle at var(--x,50%) var(--y,50%), rgba(120,140,255,0.25), transparent 300px),
        linear-gradient(rgba(5,10,25,0.92), rgba(5,10,25,0.98)),
        url("https://images.unsplash.com/photo-1524995997946-a1c2e315a42f");
    background-size:cover;
    background-position:center;
    background-attachment:fixed;
    color:#ffffff;
    font-family:"Segoe UI", sans-serif;
}

/* ===== NAVBAR ===== */
.navbar{
    background:rgba(10,10,30,0.65)!important;
    backdrop-filter:blur(14px);
    box-shadow:0 0 25px rgba(0,0,0,0.6);
}

/* ===== POST BOX ===== */
.post-box{
    background:rgba(255,255,255,0.10);
    backdrop-filter:blur(20px);
    border-radius:22px;
    padding:18px;
    box-shadow:0 12px 40px rgba(0,0,0,0.9);
}

/* ===== INPUTS ===== */
.form-control,
.form-select{
    background:rgba(255,255,255,0.18);
    border:none;
    color:#fff!important;
    border-radius:14px;
    transition:0.25s;
}

.form-control::placeholder{
    color:#d1d5db;
}

.form-control:focus,
.form-select:focus{
    background:rgba(255,255,255,0.30);
    box-shadow:0 0 18px rgba(99,102,241,0.9);
    transform:translateY(-3px);
}

/* ===== CARDS ===== */
.card{
    background:rgba(255,255,255,0.12);
    backdrop-filter:blur(20px);
    border-radius:24px;
    border:1px solid rgba(255,255,255,0.15);
    transition:0.28s;
    color:#fff;
}

.card:hover{
    transform:translateY(-16px) scale(1.05);
    box-shadow:0 25px 70px rgba(0,0,0,1);
}

/* ===== BADGES ===== */
.lost-badge{
    background:linear-gradient(145deg,#1f2937,#020617);
    color:#60a5fa !important;
    font-weight:800;
    padding:9px;
    border-radius:12px;
}

.found-badge{
    background:linear-gradient(145deg,#1f2937,#020617);
    color:#22d3ee !important;
    font-weight:800;
    padding:9px;
    border-radius:12px;
}

/* ===== BUTTONS ===== */
.btn{
    border:none;
    transition:0.2s;
    font-weight:600;
}

.btn:hover{
    transform:translateY(-4px) scale(1.06);
}

.btn-success{
    background:linear-gradient(45deg,#16a34a,#22c55e);
}

.btn-primary{
    background:linear-gradient(45deg,#6366f1,#9333ea);
}

.btn-outline-light{
    border:2px solid rgba(255,255,255,0.8);
    background:rgba(0,0,0,0.25);
    margin-top:10px;
}

.btn-outline-light:hover{
    background:#ef4444;
    border-color:#ef4444;
    color:#fff;
}

.text-muted{
    color:#e5e7eb!important;
}
/* ===== DARK SEARCH + DROPDOWN FIX ===== */

/* search input text color */
#searchInput{
    background:#020617 !important;
    color:white !important;
    border:1px solid rgba(255,255,255,0.25);
}

#searchInput::placeholder{
    color:#cbd5e1 !important;
}

/* category filter dropdown */
#categoryFilter{
    background:#020617 !important;
    color:white !important;
    border:1px solid rgba(255,255,255,0.25);
}

/* posting category + status dropdowns */
select.form-select{
    background:#020617 !important;
    color:white !important;
}

/* options inside dropdown */
select.form-select option{
    background:#020617;
    color:white;
}

/* hover highlight inside list */
select.form-select option:hover{
    background:#1e293b;
}

/* focus glow */
#searchInput:focus,
#categoryFilter:focus,
select.form-select:focus{
    box-shadow:0 0 14px rgba(99,102,241,0.8) !important;
    border-color:#6366f1 !important;
}


</style>
</head>

<body>

<nav class="navbar navbar-dark">
  <div class="container">
    <span class="navbar-brand fw-bold fs-4">üè¥‚Äç‚ò†Ô∏è Campus Recovery</span>

    <div class="text-light">
        Logged in: {{email}}
        <a href="/logout" class="btn btn-outline-light btn-sm ms-3">Logout</a>
    </div>
  </div>
</nav>

<div class="container mt-4">

    <!-- POST ITEM -->
    <div class="post-box mb-4">
        <form action="/add" method="POST" class="row g-2">

            <div class="col-md-3">
                <input type="text" name="name" class="form-control" placeholder="Item name" required>
            </div>

            <div class="col-md-3">
                <input type="text" name="location" class="form-control" placeholder="Where lost/found?" required>
            </div>

            <div class="col-md-3">
                <input type="text" name="contact" class="form-control" placeholder="Phone or Email" required>
            </div>

            <!-- CATEGORY -->
            <div class="col-md-2">
                <select name="category" class="form-select" required>
                    <option value="Mobile">üì± Mobile</option>
                    <option value="Charger">üîå Charger</option>
                    <option value="Mobile Case">üì± Mobile Case</option>
                    <option value="Keys">üîë Keys</option>
                    <option value="Bluetooth">üéß Bluetooth</option>
                    <option value="Books">üìö Books</option>
                    <option value="ID Card">ü™™ ID Card</option>
                    <option value="Calculator">üßÆ Calculator</option>
                    <option value="Others">üì¶ Others</option>
                </select>
            </div>

            <div class="col-md-2">
                <select name="status" class="form-select">
                    <option value="Lost">Lost</option>
                    <option value="Found">Found</option>
                </select>
            </div>

            <input type="hidden" name="description" value="reported item">

            <div class="col-md-1 d-grid">
                <button class="btn btn-primary">Post</button>
            </div>

        </form>
    </div>

    <!-- SEARCH -->
    <div class="mb-3">
        <input type="text" id="searchInput" class="form-control"
               placeholder="üîç Search item name...">
    </div>

    <!-- FILTER -->
    <div class="mb-4">
        <select id="categoryFilter" class="form-select">
            <option value="all">All Categories</option>
            <option value="Mobile">Mobile</option>
            <option value="Charger">Charger</option>
            <option value="Mobile Case">Mobile Case</option>
            <option value="Keys">Keys</option>
            <option value="Bluetooth">Bluetooth</option>
            <option value="Books">Books</option>
            <option value="ID Card">ID Card</option>
            <option value="Calculator">Calculator</option>
            <option value="Others">Others</option>
        </select>
    </div>

    <!-- ITEMS -->
    <div class="row">
    {% for item in items %}
        <div class="col-md-4 item-card" data-name="{{item[1]}}" data-category="{{item[6]}}">

            <div class="card p-3 mb-4">

                <h5>{{item[1]}}</h5>
                <p>üìç {{item[3]}}</p>
                <p class="text-muted">Category: {{item[6]}}</p>

                {% if item[4]=='Lost' %}
                    <span class="badge lost-badge mb-3">Lost</span>
                {% else %}
                    <span class="badge found-badge mb-3">Found</span>
                {% endif %}

                <div class="d-grid gap-2">

                    {% if '@' in item[5] %}
                    <a target="_blank"
                       href="https://mail.google.com/mail/?view=cm&fs=1&to={{item[5]}}&su=Regarding%20your%20item&body=Hello,%20I%20saw%20your%20item%20'{{item[1]}}'%20reported%20near%20{{item[3]}}."
                       class="btn btn-success">
                       üìß Contact Owner
                    </a>
                    {% else %}
                    <a href="tel:{{item[5]}}" class="btn btn-success">
                        üìû Call Owner
                    </a>
                    {% endif %}

                    {% if item[7] == email %}
                    <a href="/delete/{{item[0]}}" class="btn btn-outline-light" onclick="return confirmDelete();">
                        Remove
                    </a>
                    {% endif %}

                </div>

            </div>

        </div>
    {% endfor %}
    </div>

</div>

<script>
document.addEventListener("mousemove", e=>{
    document.body.style.setProperty("--x", e.clientX+"px");
    document.body.style.setProperty("--y", e.clientY+"px");
});

function confirmDelete(){
    return confirm("‚ö†Ô∏è Are you sure you want to permanently remove this post?");
}

/* SEARCH + FILTER */
const searchInput = document.getElementById("searchInput");
const categoryFilter = document.getElementById("categoryFilter");
const cards = document.querySelectorAll(".item-card");

function filterItems(){
    const search = searchInput.value.toLowerCase();
    const category = categoryFilter.value;

    cards.forEach(card=>{
        const name = card.dataset.name.toLowerCase();
        const cat = card.dataset.category;

        if((category==="all" || cat===category) && name.includes(search)){
            card.style.display="block";
        } else {
            card.style.display="none";
        }
    });
}

searchInput.addEventListener("keyup", filterItems);
categoryFilter.addEventListener("change", filterItems);
</script>

</body>
</html>
